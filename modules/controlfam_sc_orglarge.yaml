id: controlfam_sc_orglarge
title: "SC - System and Communications Protection (Organization: Large)"
introduction:
  format: markdown
  template: |
    Welcome to the System and Communications Protection Module!

    When you finish this section you will have a plan for protecting your
    {{project.system_stack.what_kind_of_application}} from Denial of Service
    attacks and other attacks related to online communications.

    [Idea â€“ Embedded video]

questions:
  - id: using_enterprise_dmz
    title: Using Enterprise DMZ?
    type: yesno
    prompt: |
      Since your system is hosted in your agency's internal data center, your
      communications boundary protection is provided your enterprise IT organization.

      Do you plan for your system to use the enterprise boundary protection services
      provided by your agency's internal data center?
    impute:
      - condition: not(project.system_stack.application_where_hosted == "onpremesis")
        value: ~

  - id: using_enterprise_dmz_yes
    title: Using Enterprise DMZ (Yes)
    type: interstitial
    prompt: |
      Since your system is hosted in your agency's internal data center, your
      communications boundary protection is provided your enterprise IT organization.

      You are able to inherit this control from your enterprise service.
    impute:
      - condition: not(using_enterprise_dmz == "yes")
        value: ~

  - id: using_enterprise_dmz_no
    title: Using Enterprise DMZ (No)
    type: interstitial
    prompt: |
      You know, hey, it's organization policy to have boundary protections. You said you are not using your enterprise services.

      Let's talk about why not.

  - id: have_other_dmz
    title: Do You Have Another DMZ?
    type: choice
    prompt: |
      It's organization policy to have boundary protections, but you said you are not using your enterprise services.

      Why not?
    choices:
      - key: ad_hoc_dmz
        text: The system has its own DMZ.
      - key: na
        text: The system does not need a DMZ.
      - key: wavier
        text: We are requesting a waiver for this requirement.
    ask-first:
      - using_enterprise_dmz_no
    impute:
      - condition: not(using_enterprise_dmz == "no")
        value: ~

  - id: who_responsible_for_dmz
    title: Who Is Responsible for the DMZ?
    type: module
    module-id: /point_of_contact
    prompt: |
      A secure system is protected by a properly configured firewall.

      Who in your organization is responsible for configuring your system's firewall?
    impute:
      - condition: not(have_other_dmz == 'ad_hoc_dmz')
        value: ~

output:
  - title: SSP Control Template
    format: html
    template: |
      <h3>SC-7 (3) Control Enhancement</h3>

      <p>The organization something something DMZ.</p>

      <table class="table" style="margin-top: 1.5em">
        <thead>
          <th colspan="2">
            <div class="row">
              <div class="col-xs-3">
                SC-7(3)
              </div>
              <div class="col-xs-9">
                Control Summary Information
              </div>
            </div>
          </th>
        </thead>
        <tbody>
          <tr>
            <td width="30%">Responsible Role:</th>
            <td>
              {% if project.system_stack.application_where_hosted == "onpremesis" and have_other_dmz == 'ad_hoc_dmz' %}
                {{who_responsible_for_dmz}}
              {% else %}
              N/A
              {% endif %}
            </td>
          </tr>
          <tr>
            <td>Parameter:</th>
            <td>
              {% if project.system_stack.application_where_hosted != "onpremesis" %}
              Not hosted on premesis and so does not need a DMZ.
              {% elif using_enterprise_dmz == 'yes' %}
              Enterprise DMZ.
              {% else %}
              System-specific DMZ.
              {% endif %}
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <div style="margin-bottom: .5em">Implementation Status:</div>
              {% for key, text in [
      ["implemented", "Implemented"],
      ["partially_implemented", "Partially Implemented"],
      ["planned", "Planned"],
      ["alternative_implementation", "Alternative Implementation"],
      ["not_applicable", "Not Applicable"]] %}
              <div class="radio">
                <label>
                  <input type="checkbox" disabled="disabled" {% if key == "implemented" %}checked="checked"{% endif %}> {{text}} 
                </label>
              </div>
              {% endfor %}
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <div style="margin-bottom: .5em">Control Origination:</div>

              {% for key, text in [["service_provider_corporate", "Service Provider Corporate"],
      ["service_provider_system_specific", "Service Provider System Specific"],
      ["service_provider_hybrid", "Service Provider Hybrid (Corporate and System Specific)"],
      ["configured_by_customer", "Configured by Customer (Customer System Specific)"],
      ["provided_by_customer", "Provided by Customer (Customer System Specific)"],
      ["shared", "Shared (Service Provider and Customer Responsibility)"],
      ["inherited", "Inherited from pre-existing FedRAMP Authorization"]] %}
              <div class="radio">
                <label>
                  <input type="checkbox" disabled="disabled"
                    {% if key == "service_provider_corporate" and using_enterprise_dmz == "no" %}checked="checked"{% endif %}
                    {% if key == "inherited" and using_enterprise_dmz == "yes" %}checked="checked"{% endif %}
                    > {{text}} 
                </label>
              </div>
              {% endfor %}
            </td>
          </tr>
        </body>
      </table>

      <table class="table">
        <thead>
          <th colspan="2">
            SC-7 (3) What is the solution and how is it implemented?
          </th>
        </thead>
        <tbody>
          <tr>
            <td colspan="2">
              {% if project.system_stack.application_where_hosted != "onpremesis" %}
                The system is not hosted on premesis and so it does not need a DMZ.

              {% elif using_enterprise_dmz == 'yes' %}
                {% if 0 %}
                {# using_enterprise_dmz_yes is here just to trigger it as something to be answered #}
                {{using_enterprise_dmz_yes}}
                {% endif %}
              
                The system is using our enterprise DMZ.

              {% else %}

                The system is not using our enterprise DMZ. {{have_other_dmz.text}}

              {% endif %}
            </td>
          </tr>
        </tbody>
      </table>
