id: control_au_2_3
title: AU-2 (3) Control Enhancement to AU-2 Audit Events
introduction:
  format: markdown
  template: |
    ![AU icon](control-au.png)

    In this section you will provide the responsible role, parameters, implementation status, control origination, and solution/implementation for AU-2 (3).

    AU-2 (3) states:

    > The organization reviews and updates the audited events [FedRAMP Assignment: annually or whenever there is a change in the threat environment].

    AU-2 (3) Additional FedRAMP Requirements and Guidance: 

    > Guidance: Annually or whenever changes in the threat environment are communicated to the service provider by the JAB/AO.
questions:
  - id: keep_responsible_role
    title: Keep Default Responsible Role
    prompt: Is {{project.responsible_roles.AU}} the responsible role for the implementation of this control?
    type: yesno
    impute:
      - condition: project.responsible_roles.AU is none
        value: no

  - id: responsible_role
    title: Responsible Role
    prompt: Who is responsible for the implementation of this control?
    type: module
    module-id: responsible_role
    impute:
      - condition: keep_responsible_role == 'yes'
        value: project.responsible_roles.AU
        value-mode: expression

  - id: parameter
    title: Parameter AU-2(3)
    prompt: |
      This control enhancement has a parameter:

      > The organization reviews and updates the audited events **[FedRAMP Assignment: annually or whenever there is a change in the threat environment]**.

      How often does the organization review and update the audited events? FedRAMP specifies annually or whenever there is a change in the threat environment.
    type: text

  - id: implementation_status
    title: Implementation Status
    prompt: What is the implementation status of this control?
    type: multiple-choice
    min: 1
    choices:
      - key: implemented
        text: Implemented
      - key: partially_implemented
        text: Partially Implemented
      - key: planned
        text: Planned
      - key: alternative_implementation
        text: Alternative Implementation
      - key: not_applicable
        text: Not Applicable

  - id: planned_implementation_date
    title: Planned Implementation Date
    prompt: What is the planned implementation date for this control?
    type: date
    impute:
      - condition: "implementation_status is none or 'planned' not in implementation_status"
        value: ~

  - id: control_origination
    title: Control Origination
    prompt: |
      What is this control's origination?

      {% if project.system_stack.cloud_provider == 'aws' %}
      **Your cloud provider is {{project.system_stack.cloud_provider.text}} so you must choose Inherited from pre-existing FedRAMP Authorization, and any other control originations as applicable.**
      {% endif %}
    type: multiple-choice
    min: 1
    choices:
      - key: service_provider_corporate
        text: Service Provider Corporate
      - key: service_provider_system_specific
        text: Service Provider System Specific
      - key: service_provider_hybrid
        text: Service Provider Hybrid (Corporate and System Specific)
      - key: configured_by_customer
        text: Configured by Customer (Customer System Specific)
      - key: provided_by_customer
        text: Provided by Customer (Customer System Specific)
      - key: shared
        text: Shared (Service Provider and Customer Responsibility)
      - key: inherited
        text: Inherited from pre-existing FedRAMP Authorization
        help: You'll choose the authorization document next.

  - id: inherited_authorization
    title: Inherited Authorization
    prompt: What pre-existing FedRAMP Authorization does this control origination inherit from?
    type: module
    module-id: fedramp_authorization
    impute:
      - condition: "control_origination is none or 'inherited' not in control_origination"
        value: ~

  - id: implementation
    title: Solution and Implementation
    prompt: |
      What is the solution for this control enhancement and how is it implemented?

      {% if project.system_stack.cloud_provider != 'other' %}
      Your cloud provider is **{{project.system_stack.cloud_provider.text}}**. The solution and implementation for this control enhancement will include your cloud provider's auditing practices.
      {% endif %}

      {% if project.system_stack.application_software != 'other' %}
      Your application is based on **{{project.system_stack.application_software.text}}**. The solution and implementation for this control enhancement will include your application layer's auditing practices.
      {% endif %}

      {% if project.system_stack.cloud_provider != 'other' or project.system_stack.application_software != 'other'%}
      Do you have anything to add?
      {% endif %}

    type: longtext

output:
  - title: Your Answers
    format: html
    template: |
      <table class="table">
        <thead>
          <th colspan="2">
            <div class="row">
              <div class="col-xs-3">
                AU-1
              </div>
              <div class="col-xs-9">
                Control Summary Information
              </div>
            </div>
          </th>
        </thead>
        <tbody>
          <tr>
            <td>Responsible Role:</th>
            <td>{{responsible_role}}</td>
          </tr>
          <tr>
            <td>Parameter:</th>
            <td>{{parameter.text}}</td>
          </tr>
          <tr>
            <td colspan="2">
              <div style="margin-bottom: .5em">Implementation Status:</div>
              {% for value in implementation_status %}
                <div>{{value.text}} {% if value == "planned" %} ({{planned_implementation_date.text}}){% endif %}</div>
              {% else %}
                <div>(no implementation status selected)</div>
              {% endfor %}
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <div style="margin-bottom: .5em">Control Origination:</div>
              {% for value in control_origination %}
                <div>{{value.text}} {% if value == "inherited" %} ({{inherited_authorization.title}}){% endif %}</div>
              {% else %}
                <div>(no control origination selected)</div>
              {% endfor %}
            </td>
          </tr>
        </body>
      </table>

      <table class="table">
        <thead>
          <th colspan="2">
            AU-2 (3) What is the solution and how is it implemented?
          </th>
        </thead>
        <tbody>
          <tr>
            <td colspan="2">
              {% if project.system_stack.cloud_provider != 'other' %}
              <p>[{{project.system_stack.cloud_provider.text}} solution/implementation here]</p>
              {% endif %}

              {% if project.system_stack.application_software != 'other' %}
              <p>[{{project.system_stack.application_software.text}} solution/implementation here]</p>
              {% endif %}

              {{implementation.text}}
            </td>
          </tr>
        </tbody>
      </table>
