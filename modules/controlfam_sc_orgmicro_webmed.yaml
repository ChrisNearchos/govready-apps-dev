id: controlfam_sc_orgmicro_webmed
title: "System and Communications Protection (SC)"
introduction:
  format: html
  template: |
    <p>In this section, we'll guide you through setting up secure communications for your web application.</p>

    <p>Completing this section will document the controls you have in place to prevent network-based attacks.</p>

    <p>Watch the video below for a short overview.</p>

    <iframe src="https://player.vimeo.com/video/180259912" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>

questions:
  - id: has_firewall
    title: Have a Firewall?
    type: yesno
    prompt: |
      A secure system is protected by a firewall.

      {% if project.system_stack.cloud_provider == "AWS" %}
      Amazon Web Services's "security groups" are firewalls that protect machine instances in EC2.
      Besides the AWS security groups, does your system have an additional firewall?

      {% elif project.system_stack.application_where_hosted == "cloud" %}
      Cloud providers, such as {{project.system_stack.cloud_provider.text}}, often have firewall
      services built-in. Besides the firewall services provided by {{project.system_stack.cloud_provider.text}},
      does your system have an additional firewall?

      {% else %}
      Does your system have a firewall?
      {% endif %}

  - id: who_configures_aws_security_groups
    title: Who Configures The AWS Security Groups?
    type: text
    prompt: |
      {{project.system_stack.cloud_provider.text}} Security Groups must be properly configured.

      Who in your organization is responsible for configuring {{project.system_stack.cloud_provider.text}}  Security Groups?
    impute:
      - condition: has_firewall == 'yes'
        value: ~

  - id: who_configures_firewall
    title: Who Configures The Firewall?
    type: text
    prompt: |
      A secure firewall must be properly configured.

      Who in your organization is responsible for configuring your system's firewall?
    impute:
      - condition: has_firewall == 'no'
        value: ~

  - id: how_to_know_that_firewall_is_configured
    title: How To Know That The Firewall Is Configured
    type: interstitial
    prompt: |
      A System Security Plan includes evidence of a properly configured firewall.
      
      Good evidence that your firewall is configured is a screenshot of the firewall
      configuration settings. Next, we will help you get that evidence.

  - id: evidence_that_firewall_is_configured
    title: Evidence That The Firewall Is Configured
    type: longtext
    prompt: |
      [In this question we would provide customized advice depending on the system'system_stack
      actual firewall software in use.]
    ask-first:
      - how_to_know_that_firewall_is_configured
    impute:
      - condition: has_firewall == 'no'
        value: ~

  - id: firewall_log_date
    title: Firewall Log Last Checked
    type: date
    prompt: |
      A secure system should be monitored for firewall activity.

      When did the person responsible for monitoring firewall activity last look at the log files of your system's firewall?
    impute:
      - condition: has_firewall == 'no'
        value: ~

output:
  - title: SSP Control Template
    format: html
    template: |
      <h3>SC-7 Boundary Protection</h3>

      <h3>Control Description</h3>

      <p>The information system:</p>
      <p>a.  Monitors and controls communications at the external boundary of the system and at key internal boundaries within the system;<p>
      <p>b.  Implements subnetworks for publicly accessible system components that are [Selection: physically; logically] separated from internal organizational networks; and</p>
      <p>c.  Connects to external networks or information systems only through managed interfaces consisting of boundary protection devices arranged in accordance with an organizational security architecture.</p>

      <table class="table" style="margin-top: 1.5em">
        <thead>
          <th colspan="2">
            <div class="row">
              <div class="col-xs-3">
                SC-7
              </div>
              <div class="col-xs-9">
                Control Summary Information
              </div>
            </div>
          </th>
        </thead>
        <tbody>
          <tr>
            <td width="30%">Responsible Role:</th>
            <td>
              {% if has_firewall %}
                {{who_configures_firewall.text}}
              {% else %}
                {{who_configures_aws_security_groups.text}}
              {% endif %}
            </td>
          </tr>
          {% if has_firewall %}
          <tr>
            <td>Parameter:</th>
            <td>Has standalone firewall: {{has_firewall.text}}</td>
          </tr>
          {% endif %}
          <tr>
            <td colspan="2">
              <div style="margin-bottom: .5em">Implementation Status:</div>
              {% for key, text in [
      ["implemented", "Implemented"],
      ["partially_implemented", "Partially Implemented"],
      ["planned", "Planned"],
      ["alternative_implementation", "Alternative Implementation"],
      ["not_applicable", "Not Applicable"]] %}
              <div class="radio">
                <label>
                  <input type="checkbox" disabled="disabled" {% if key == "implemented" %}checked="checked"{% endif %}> {{text}}
                </label>
              </div>
              {% endfor %}
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <div style="margin-bottom: .5em">Control Origination:</div>

              {% for key, text in [["service_provider_corporate", "Service Provider Corporate"],
      ["service_provider_system_specific", "Service Provider System Specific"],
      ["service_provider_hybrid", "Service Provider Hybrid (Corporate and System Specific)"],
      ["configured_by_customer", "Configured by Customer (Customer System Specific)"],
      ["provided_by_customer", "Provided by Customer (Customer System Specific)"],
      ["shared", "Shared (Service Provider and Customer Responsibility)"],
      ["inherited", "Inherited from pre-existing FedRAMP Authorization"]] %}
              <div class="radio">
                <label>
                  <input type="checkbox" disabled="disabled" {% if key == "service_provider_corporate" %}checked="checked"{% endif %}> {{text}}
                </label>
              </div>
              {% endfor %}
            </td>
          </tr>
        </body>
      </table>

      <table class="table">
        <thead>
          <th colspan="2">
            SC-7 What is the solution and how is it implemented?
          </th>
        </thead>
        <tbody>
          <tr>
            <td colspan="2">
              {% if has_firewall %}
              <p>Evidence: {{evidence_that_firewall_is_configured.text}}</p>
              <p>Last Monitored: {{firewall_log_date.text}}</p>
              {% else %}

              <p>The {{project}} information system:</p>
              <p>a.  Monitors and controls communications at the external boundary of the system and at key internal boundaries within the system with {{project.system_stack.cloud_provider.text}} Security Groups that function as firewalls and actively monitor and control all communication interfaces to the internet and between defined internal system partitions.<p>
              <p>b.  Implements subnetworks for publicly accessible system components that are logically separated from internal organizational networks by configuring different security groups to establish logically separated subnetworks; and</p>
              <p>c.  Connects to external networks or information systems only through managed interfaces consisting of boundary protection devices arranged in accordance with an organizational security architecture by using {{project.system_stack.cloud_provider.text}} Security Groups which are required in {{project.system_stack.cloud_provider.text}} to connect to external networks (e.g., Internet) and other information systems.</p>


              {% endif %}
            </td>
          </tr>
        </tbody>
      </table>
